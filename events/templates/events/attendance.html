{% comment %} # requires context: event and user and date
This is the block of code that handles all of the attendance HTML: Drop this in where you want an attend button set.
{% endcomment %}
  {% if user and not user.is_anonymous %}
    {% if date < event.date %}
      {% if not user in event.users %}
        {% if event.signed_up.count < event.max_attendees %}
          <div style="width:150px" class=".TxtArea{{event.id}} collapse in" id="vanish{{event.id}}"><a href="#!" class="btn btn-success" role="button" aria-label="Attend Event" data-toggle="collapse" data-target=".TxtArea{{event.id}}, #vanish{{event.id}}">Attend Event</a></div>
          {% include "events/attend.html" with event=event user=user %}
        {% else %}
          <div style="width:150px" class=".TxtArea{{event.id}} collapse in" id="vanish{{event.id}}"><a href="#!" class="btn btn-primary" role="button" aria-label="Attend as substitute" data-toggle="collapse" data-target=".TxtArea{{event.id}}, #vanish{{event.id}}">Substitute in Event</a></div>
          {% include "events/attend.html" with event=event user=user %}        
        {% endif %}
    {% else %}
      {% if user in event.leaving %}
        {% include 'events/unleaving.html' with event=event user=user %}
      {% else %}
        {% if event.signed_up.count > event.min_attendees or not event.locked %}
          <div style="width:150px"><a href="#!" class="btn btn-danger" role="button" aria-label="Not Attending" data-toggle="modal" data-target="#ModalUnattend{{M}}{{event.id}}">Not Attending</a></div>
          {% include 'events/leave.html' with event=event user=user %}
        {% else %}
          <div style="width:150px"><a href="#!" class="btn btn-warning" role="button" aria-label="Queue Leaving" data-toggle="modal" data-target="#ModalUnattend{{M}}{{event.id}}">Queue Leaving</a></div>
          {% include 'events/leave.html' with event=event user=user %}
        {% endif %}
      {% endif %}
      {% endif %}
    {% endif %}
  {% endif %}

